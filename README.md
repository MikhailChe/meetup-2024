# Vertis Java meetup
## Раскапываем gRPC

Вы наверняка попали сюда, потому что посмотрели митап
https://events.yandex.ru/events/vertech/java-meetup

Здесь я собрал примеры, которые показывал на слайде. Для хранения списка зависимостей я решил использовать .iml (IntelliJ файлик), но при желании, могу сконвертировать в maven или gradle файлы.

TLDR: начинайте с папки `src/bin`.

# proto
Здесь прото-описание тестового сервиса. На слайде с сервером был только `rpc Search`, но в дальнейшем я использовал и Dummy для демонстрации дедлоков.

# generated
Тут я сгенерировал для вас java-имплементацию из прото-описания.

# resources
Тут конфиг для log4j2, там базовый консольный логгер, который выводит всё от уровня info. Вывод содержит имя потока, а все потоки в сервере и клиенте я попытался именовать, поэтому легко понять какая часть кода в какой thread попадает.

# src
## bin
Здесь собраны несколько разных вариантов запуска сервера в разных комбинациях.
### DirectServerBlockingClient
Сервер на directExecutor и сервис, который вызывает блокирующий клиент.
### DirectServerFutureClient
Сервер на directExecutor, но сервис использует FutureStub и в целом реализация сваливается в использование CompletableFuture почти сразу.
### ExecutorServerBlockingClient
Сервер с кастомным экзекьютором и блокирующим клиентом.

## client
Тут базовый билдер клиента, который формирует канал в localhost и два метода для получения blockingStub и futureStub клиентов. В целом, клиент можно и руками создать канал, а потом передать его в newFutureStub/newBlockingStub, но так кажется чуть удобнее.

## interceptors
Тут два интерцептора: для клиента и для сервера. Базовый функционал вида "залогируй всё что есть".
В докладе я рассказывал про exception в ClientCallListener, можно как раз попробовать повыбрасывать RuntimeException из разных мест.

## server
Билдер для сервера. Так же как и для клиента там добален интерсептор и есть несколько методов с разными экзекьюторами.

## service
Несколько простых реализация сервера. Одна - с использованием блокирующего клиента, а другая - с использованием future клиента.

## pages
Здесь 4 пакета, которые либо напрямую были показаны на слайдах, либо использовались для создания слайдов (диаграммы)